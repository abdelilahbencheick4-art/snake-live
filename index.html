<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Maze Live</title>

<style>
body{
    margin:0;
    background:#2b002f;
    font-family:Arial;
    display:flex;
    flex-direction:column;
    align-items:center;
}

#nowPlaying{
    width:95%;
    margin-top:10px;
    background:linear-gradient(90deg,#ff0000,#ff6600);
    padding:8px;
    color:white;
    font-weight:bold;
    border-radius:8px;
    box-shadow:0 0 15px red;
}

canvas{
    margin-top:10px;
    background:#300040;
    border:5px solid red;
    border-radius:20px;
    box-shadow:0 0 30px red;
}

#stats{
    color:white;
    margin-top:8px;
    display:flex;
    gap:20px;
}

#giftOverlay{
    position:absolute;
    right:10px;
    top:100px;
    background:rgba(0,0,0,0.6);
    padding:10px;
    border-radius:15px;
    color:white;
    font-size:14px;
}
</style>
</head>

<body>

<div id="nowPlaying">NOW PLAYING - Sprinter.mp3</div>

<canvas id="game"></canvas>

<div id="stats">
<div>WIN: <span id="win">0</span></div>
<div>LOSS: <span id="loss">0</span></div>
<div>SCORE: <span id="score">0</span></div>
</div>

<div id="giftOverlay">
‚ù§Ô∏è +10 Apples<br>
üç© Bomb Game Over<br>
üìº Infinite Apples WIN
</div>

<script>

const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

const GRID=30;
const SIZE=20;

canvas.width=GRID*SIZE;
canvas.height=GRID*SIZE;

let maze=[];
let snake=[];
let apples=[];
let bombs=[];
let score=0;
let win=0;
let loss=0;
let length=3;

// MAZE SIMPLE
for(let y=0;y<SIZE;y++){
    maze[y]=[];
    for(let x=0;x<SIZE;x++){
        maze[y][x]= (x===0||y===0||x===SIZE-1||y===SIZE-1)?1:0;
    }
}

function init(){
    snake=[{x:2,y:2}];
    apples=[];
    bombs=[];
    length=3;
    spawnApple(3);
}

function spawnApple(n=1){
    for(let i=0;i<n;i++){
        apples.push({
            x:Math.floor(Math.random()*(SIZE-2))+1,
            y:Math.floor(Math.random()*(SIZE-2))+1
        });
    }
}

function spawnBomb(){
    bombs.push({
        x:Math.floor(Math.random()*(SIZE-2))+1,
        y:Math.floor(Math.random()*(SIZE-2))+1
    });
}

function drawMaze(){
    for(let y=0;y<SIZE;y++){
        for(let x=0;x<SIZE;x++){
            if(maze[y][x]===1){
                ctx.fillStyle="#ffff88";
                ctx.fillRect(x*GRID,y*GRID,GRID,GRID);
                ctx.shadowBlur=20;
                ctx.shadowColor="yellow";
            }
        }
    }
}

function update(){

    let head=snake[0];
    let target=apples[0];

    let dx=Math.sign(target.x-head.x);
    let dy=Math.sign(target.y-head.y);

    let newHead={x:head.x+dx,y:head.y+dy};

    if(maze[newHead.y][newHead.x]===1 || snake.some(s=>s.x===newHead.x&&s.y===newHead.y)){
        loss++;
        init();
        return;
    }

    if(bombs.some(b=>b.x===newHead.x&&b.y===newHead.y)){
        loss++;
        init();
        return;
    }

    snake.unshift(newHead);

    let index=apples.findIndex(a=>a.x===newHead.x&&a.y===newHead.y);
    if(index!==-1){
        length++;
        score+=10;
        apples.splice(index,1);
        spawnApple();
        if(length>50){
            win++;
            init();
        }
    }

    while(snake.length>length){
        snake.pop();
    }

    draw();
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    drawMaze();

    // apples
    apples.forEach(a=>{
        ctx.shadowBlur=15;
        ctx.shadowColor="red";
        ctx.fillStyle="red";
        ctx.beginPath();
        ctx.arc(a.x*GRID+GRID/2,a.y*GRID+GRID/2,GRID/2-5,0,Math.PI*2);
        ctx.fill();
    });

    // snake
    snake.forEach((s,i)=>{
        ctx.shadowBlur=10;
        ctx.shadowColor="lime";
        ctx.fillStyle=i===0?"#00ff00":"#00aa55";
        ctx.beginPath();
        ctx.ellipse(s.x*GRID+GRID/2,s.y*GRID+GRID/2,GRID/2-4,GRID/2-6,0,0,Math.PI*2);
        ctx.fill();
    });

    ctx.shadowBlur=0;

    document.getElementById("score").innerText=score;
    document.getElementById("win").innerText=win;
    document.getElementById("loss").innerText=loss;
}

setInterval(update,120);

init();

</script>
</body>
</html>
