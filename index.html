<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Classic Smooth</title>

<style>
html,body{
    margin:0;
    height:100%;
    background:black;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:Arial;
}

#gameWrapper{
    display:flex;
    flex-direction:column;
    align-items:center;
}

#title{
    color:white;
    margin-bottom:10px;
    font-size:22px;
}

canvas{
    background:#8ED14F;
    border:10px solid #5c8c2a;
    border-radius:25px;
    box-shadow:0 0 40px rgba(0,0,0,0.7);
}
</style>
</head>

<body>

<div id="gameWrapper">
    <div id="title">Snake Game</div>
    <canvas id="game"></canvas>
</div>

<script>

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const TILE = 25;
const SIZE = 20;

canvas.width = TILE * SIZE;
canvas.height = TILE * SIZE;

let snake = [{x:5,y:5},{x:4,y:5},{x:3,y:5}];
let direction = {x:1,y:0};
let apple = randomApple();
let speed = 120;

function randomApple(){
    return {
        x: Math.floor(Math.random()*SIZE),
        y: Math.floor(Math.random()*SIZE)
    };
}

function reset(){
    snake = [{x:5,y:5},{x:4,y:5},{x:3,y:5}];
    direction = {x:1,y:0};
    apple = randomApple();
}

function update(){

    let head = {
        x: snake[0].x + direction.x,
        y: snake[0].y + direction.y
    };

    // collision mur
    if(head.x<0 || head.y<0 || head.x>=SIZE || head.y>=SIZE){
        reset();
        return;
    }

    // collision soi-même
    if(snake.some(s=>s.x===head.x && s.y===head.y)){
        reset();
        return;
    }

    snake.unshift(head);

    // mange pomme
    if(head.x===apple.x && head.y===apple.y){
        apple = randomApple();
    }else{
        snake.pop();
    }

    draw();
}

function draw(){

    ctx.clearRect(0,0,canvas.width,canvas.height);

    // damier fond
    for(let y=0;y<SIZE;y++){
        for(let x=0;x<SIZE;x++){
            ctx.fillStyle = (x+y)%2===0 ? "#9ddc59" : "#8ed14f";
            ctx.fillRect(x*TILE,y*TILE,TILE,TILE);
        }
    }

    // pomme
    ctx.fillStyle="red";
    ctx.beginPath();
    ctx.arc(
        apple.x*TILE + TILE/2,
        apple.y*TILE + TILE/2,
        TILE/2 - 3,
        0,
        Math.PI*2
    );
    ctx.fill();

    // snake corps continu
    ctx.lineWidth = TILE - 6;
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.strokeStyle = "#2f55d4";

    ctx.beginPath();
    for(let i=0;i<snake.length;i++){
        let s = snake[i];
        let px = s.x*TILE + TILE/2;
        let py = s.y*TILE + TILE/2;
        if(i===0){
            ctx.moveTo(px,py);
        }else{
            ctx.lineTo(px,py);
        }
    }
    ctx.stroke();

    // yeux
    let head = snake[0];
    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(head.x*TILE+TILE/2-4, head.y*TILE+TILE/2-4, 3,0,Math.PI*2);
    ctx.arc(head.x*TILE+TILE/2+4, head.y*TILE+TILE/2-4, 3,0,Math.PI*2);
    ctx.fill();
}

setInterval(update,speed);

// contrôle tactile simple (swipe mobile)
let startX,startY;

canvas.addEventListener("touchstart",e=>{
    startX = e.touches[0].clientX;
    startY = e.touches[0].clientY;
});

canvas.addEventListener("touchend",e=>{
    let dx = e.changedTouches[0].clientX - startX;
    let dy = e.changedTouches[0].clientY - startY;

    if(Math.abs(dx) > Math.abs(dy)){
        direction = dx>0 ? {x:1,y:0} : {x:-1,y:0};
    }else{
        direction = dy>0 ? {x:0,y:1} : {x:0,y:-1};
    }
});

</script>

</body>
</html>
