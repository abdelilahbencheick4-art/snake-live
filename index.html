
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Live</title>
<style>
body{
    margin:0;
    background:#0d0015;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}
canvas{
    background:#1a0025;
    border:4px solid #00ffcc;
    border-radius:15px;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<script>

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const GRID = 25;
const SIZE = 20;

canvas.width = GRID * SIZE;
canvas.height = GRID * SIZE;

let snake = [{x:10,y:10}];
let length = 5;
let apples = [];
let direction = {x:1,y:0};
let score = 0;

function randomPos(){
    return {
        x: Math.floor(Math.random()*SIZE),
        y: Math.floor(Math.random()*SIZE)
    };
}

function spawnApple(){
    apples.push(randomPos());
}

spawnApple();

function update(){

    let head = {
        x: snake[0].x + direction.x,
        y: snake[0].y + direction.y
    };

    // Collision mur
    if(head.x<0 || head.y<0 || head.x>=SIZE || head.y>=SIZE){
        reset();
        return;
    }

    // Collision soi-mÃªme
    if(snake.some(s=>s.x===head.x && s.y===head.y)){
        reset();
        return;
    }

    snake.unshift(head);

    // Mange pomme
    let index = apples.findIndex(a=>a.x===head.x && a.y===head.y);
    if(index !== -1){
        length++;
        score+=10;
        apples.splice(index,1);
        spawnApple();
    }

    while(snake.length > length){
        snake.pop();
    }

    draw();
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // pommes
    ctx.fillStyle="red";
    apples.forEach(a=>{
        ctx.beginPath();
        ctx.arc(a.x*GRID+GRID/2,a.y*GRID+GRID/2,GRID/2-2,0,Math.PI*2);
        ctx.fill();
    });

    // snake
    snake.forEach((s,i)=>{
        ctx.fillStyle=i===0?"#00ffcc":"#00997a";
        ctx.beginPath();
        ctx.arc(s.x*GRID+GRID/2,s.y*GRID+GRID/2,GRID/2-1,0,Math.PI*2);
        ctx.fill();
    });

    ctx.fillStyle="white";
    ctx.fillText("Score: "+score,10,20);
}

function reset(){
    snake=[{x:10,y:10}];
    length=5;
    score=0;
    apples=[];
    spawnApple();
}

setInterval(update,120);

</script>

</body>
</html>
