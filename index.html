<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake AI Perfect</title>

<style>
html, body {
    margin:0;
    height:100%;
    background:#111;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:Arial;
}

#info{
    position:absolute;
    top:20px;
    color:white;
    font-size:20px;
}

canvas{
    background:#222;
    border:4px solid #4CAF50;
    border-radius:15px;
    box-shadow:0 0 40px rgba(76,175,80,0.5);
}
</style>
</head>
<body>

<div id="info">Score: <span id="score">0</span></div>
<canvas id="game"></canvas>

<script>

const TILE = 20;
const COLS = 20;
const ROWS = 20;

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = TILE * COLS;
canvas.height = TILE * ROWS;

let snake = [];
let apple = {};
let score = 0;

// Cr√©ation du cycle Hamiltonien simple (zigzag parfait)
let cycle = [];

for(let y=0; y<ROWS; y++){
    if(y % 2 === 0){
        for(let x=0; x<COLS; x++){
            cycle.push({x,y});
        }
    } else {
        for(let x=COLS-1; x>=0; x--){
            cycle.push({x,y});
        }
    }
}

function init(){
    snake = [cycle[0], cycle[1], cycle[2]];
    score = 0;
    spawnApple();
}

function spawnApple(){
    do{
        apple = {
            x: Math.floor(Math.random()*COLS),
            y: Math.floor(Math.random()*ROWS)
        };
    } while(snake.some(s=>s.x===apple.x && s.y===apple.y));
}

function update(){

    let head = snake[0];

    // Trouver position actuelle dans le cycle
    let index = cycle.findIndex(c => c.x === head.x && c.y === head.y);

    // Prochaine case du cycle
    let next = cycle[(index + 1) % cycle.length];

    snake.unshift(next);

    if(next.x === apple.x && next.y === apple.y){
        score++;
        document.getElementById("score").innerText = score;
        spawnApple();
    } else {
        snake.pop();
    }

    draw();
}

function draw(){

    // fond damier
    for(let y=0;y<ROWS;y++){
        for(let x=0;x<COLS;x++){
            ctx.fillStyle = (x+y)%2===0 ? "#2a2a2a" : "#333";
            ctx.fillRect(x*TILE,y*TILE,TILE,TILE);
        }
    }

    // pomme
    ctx.fillStyle="red";
    ctx.beginPath();
    ctx.arc(
        apple.x*TILE+TILE/2,
        apple.y*TILE+TILE/2,
        TILE/2-2,
        0,
        Math.PI*2
    );
    ctx.fill();

    // snake continu
    ctx.lineWidth = TILE-4;
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.strokeStyle = "#4CAF50";

    ctx.beginPath();
    ctx.moveTo(
        snake[0].x*TILE+TILE/2,
        snake[0].y*TILE+TILE/2
    );

    for(let i=1;i<snake.length;i++){
        ctx.lineTo(
            snake[i].x*TILE+TILE/2,
            snake[i].y*TILE+TILE/2
        );
    }

    ctx.stroke();

    // yeux
    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(
        snake[0].x*TILE+TILE/2-3,
        snake[0].y*TILE+TILE/2-3,
        2,0,Math.PI*2
    );
    ctx.arc(
        snake[0].x*TILE+TILE/2+3,
        snake[0].y*TILE+TILE/2-3,
        2,0,Math.PI*2
    );
    ctx.fill();
}

init();
setInterval(update, 60);

</script>

</body>
</html>
